<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Results Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&display=swap');
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #1a1a2e;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
    }
    
    .controls {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .controls button, .controls select {
      padding: 12px 20px;
      font-size: 14px;
      font-weight: 600;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background: #7745ff;
      color: white;
    }
    
    .controls button:hover {
      background: #5a2ed9;
    }
    
    .controls select {
      background: #374151;
    }
    
    /* PDF Page Container */
    .pdf-page {
      width: 595px;
      min-height: 842px;
      position: relative;
      overflow: hidden;
      font-family: 'Inter', sans-serif;
    }
    
    .pdf-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 0;
    }
    
    .pdf-content {
      position: relative;
      z-index: 1;
      padding: 20px 25px;
      color: #ffffff;
    }
    
    /* Logo - –ø—Ä–æ—Å—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ */
    .logo-container {
      margin-bottom: 15px;
    }
    
    .logo-container img {
      height: 32px;
    }
    
    /* Main Title */
    .main-title {
      font-size: 42px;
      font-weight: 900;
      margin-bottom: 4px;
      line-height: 1;
    }
    
    .main-title.passed { color: #22c55e; }
    .main-title.failed { color: #ffffff; }
    
    .attempts-text {
      font-size: 14px;
      font-weight: 300;
      color: #aca9a9;
      margin-bottom: 15px;
    }
    
    /* Info Card */
    .info-card {
      background: rgba(31, 33, 41, 0.68);
      border-radius: 18px;
      padding: 18px 20px;
      margin-bottom: 15px;
    }
    
    .test-name {
      font-size: 22px;
      font-weight: 400;
      margin-bottom: 4px;
    }
    
    .test-subtitle {
      font-size: 14px;
      font-weight: 300;
      color: #aca9a9;
      margin-bottom: 20px;
    }
    
    /* Score Section */
    .score-section {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    
    .metrics {
      display: flex;
      gap: 30px;
    }
    
    .metric {
      text-align: center;
    }
    
    .metric-value {
      font-size: 28px;
      font-weight: 900;
      color: #ffffff;
    }
    
    .metric-label {
      font-size: 12px;
      font-weight: 300;
      color: #aca9a9;
    }
    
    /* Score Circle */
    .score-circle {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .score-circle svg {
      position: absolute;
      width: 100%;
      height: 100%;
      transform: rotate(-90deg);
    }
    
    .score-circle svg circle {
      fill: none;
      stroke-width: 12;
      stroke-linecap: round;
    }
    
    .score-circle svg .bg {
      stroke: #2f2f2f;
    }
    
    .score-circle svg .progress {
      stroke: var(--progress-color, #ef4444);
      stroke-dasharray: 276;
      stroke-dashoffset: calc(276 - (276 * var(--percent, 75)) / 100);
    }
    
    .score-value {
      font-size: 28px;
      font-weight: 900;
      color: #ffffff;
      z-index: 1;
    }
    
    /* Status Badge */
    .status-badge {
      padding: 10px 20px;
      border-radius: 50px;
      font-size: 12px;
      font-weight: 500;
      margin-left: auto;
    }
    
    .status-badge.passed {
      background: rgba(34, 197, 94, 0.2);
      border: 2px solid #22c55e;
      color: #22c55e;
    }
    
    .status-badge.failed {
      background: #432027;
      border: 2px solid #eb1e1e;
      color: #ff3131;
    }
    
    /* Topics Section */
    .section-card {
      background: rgba(31, 33, 41, 0.68);
      border-radius: 18px;
      padding: 18px 20px;
      margin-bottom: 15px;
    }
    
    .section-title {
      font-size: 22px;
      font-weight: 400;
      margin-bottom: 15px;
    }
    
    /* Topic Cards Grid */
    .topics-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 10px;
    }
    
    .topic-card {
      background: linear-gradient(135deg, #2a2a3d 0%, #1f1f2e 100%);
      border-radius: 10px;
      padding: 10px;
      position: relative;
      overflow: hidden;
    }
    
    .topic-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
    }
    
    .topic-card.passed::before {
      background: #22c55e;
    }
    
    .topic-card.failed::before {
      background: #ef4444;
    }
    
    .topic-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 6px;
      gap: 5px;
    }
    
    .topic-name {
      font-size: 9px;
      font-weight: 700;
      color: #ffffff;
      line-height: 1.2;
      flex: 1;
    }
    
    .topic-status {
      font-size: 6px;
      font-weight: 500;
      padding: 2px 6px;
      border-radius: 3px;
      white-space: nowrap;
    }
    
    .topic-status.passed {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
    }
    
    .topic-status.failed {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }
    
    .topic-stats {
      display: flex;
      justify-content: space-between;
      font-size: 7px;
      color: #aca9a9;
      margin-bottom: 5px;
    }
    
    .topic-progress {
      height: 3px;
      background: #2f2f2f;
      border-radius: 2px;
      overflow: hidden;
      margin-bottom: 6px;
    }
    
    .topic-progress-fill {
      height: 100%;
      border-radius: 2px;
    }
    
    .topic-progress-fill.passed {
      background: #22c55e;
    }
    
    .topic-progress-fill.failed {
      background: #ef4444;
    }
    
    .topic-feedback {
      font-size: 6px;
      font-weight: 300;
      color: rgba(255, 255, 255, 0.7);
      line-height: 1.3;
    }
    
    /* Recommendations */
    .recommendations-subtitle {
      font-size: 11px;
      font-weight: 300;
      color: #aca9a9;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    
    .recommendation-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .recommendation-row:last-child {
      border-bottom: none;
    }
    
    .recommendation-topic {
      font-size: 16px;
      font-weight: 700;
      color: #ffffff;
    }
    
    .recommendation-course {
      background: #59209b;
      border-radius: 8px;
      padding: 10px 25px;
      font-size: 14px;
      font-weight: 300;
      color: #fafafa;
    }
    
    /* Footer */
    .pdf-footer {
      text-align: center;
      padding-top: 15px;
      font-size: 9px;
      color: rgba(255, 255, 255, 0.3);
    }
  </style>
</head>
<body>
  <div class="controls">
    <select id="bgSelect" onchange="changeBg()">
      <option value="random">–°–ª—É—á–∞–π–Ω–∞—è –ø–æ–¥–ª–æ–∂–∫–∞</option>
      <option value="1">–ü–æ–¥–ª–æ–∂–∫–∞ 1</option>
      <option value="2">–ü–æ–¥–ª–æ–∂–∫–∞ 2</option>
      <option value="3">–ü–æ–¥–ª–æ–∂–∫–∞ 3</option>
    </select>
    <button onclick="toggleStatus()">–°–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å</button>
    <button onclick="generatePDF()">üìÑ –°–∫–∞—á–∞—Ç—å PDF</button>
  </div>

  <div class="pdf-page" id="pdfPage">
    <img class="pdf-bg" id="pdfBg" src="pdf-bg-1.png" alt="">
    
    <div class="pdf-content">
      <!-- Logo - –ø—Ä–æ—Å—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ -->
      <div class="logo-container">
        <img id="pdfLogo" src="logo-dark.png" alt="–û–Ω–ª–∞–π–Ω —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç">
      </div>
      
      <!-- Main Title -->
      <div class="main-title failed" id="mainTitle">–¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω</div>
      <div class="attempts-text">–õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞ <span id="attemptsCount">2</span> –ø–æ–ø—ã—Ç–∫–∏</div>
      
      <!-- Info Card -->
      <div class="info-card">
        <div class="test-name" id="testName">–¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏</div>
        <div class="test-subtitle">–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞</div>
        
        <div class="score-section">
          <div class="metrics">
            <div class="metric">
              <div class="metric-value" id="totalQuestions">4</div>
              <div class="metric-label">–≤–æ–ø—Ä–æ—Å–∞</div>
            </div>
            <div class="metric">
              <div class="metric-value" id="correctAnswers">3/4</div>
              <div class="metric-label">–≤–æ–ø—Ä–æ—Å–∞</div>
            </div>
            <div class="metric">
              <div class="metric-value" id="totalPoints">3</div>
              <div class="metric-label">–±–∞–ª–ª–æ–≤</div>
            </div>
          </div>
          
          <div class="score-circle" id="scoreCircle" style="--percent: 75; --progress-color: #ef4444;">
            <svg viewBox="0 0 100 100">
              <circle class="bg" cx="50" cy="50" r="44"/>
              <circle class="progress" cx="50" cy="50" r="44"/>
            </svg>
            <div class="score-value" id="scoreValue">75%</div>
          </div>
          
          <div class="status-badge failed" id="statusBadge">–Ω–µ –ø—Ä–æ–π–¥–µ–Ω</div>
        </div>
      </div>
      
      <!-- Topics Section -->
      <div class="section-card">
        <div class="section-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ —Ç–µ–º–∞–º</div>
        
        <div class="topics-grid" id="topicsGrid">
          <!-- Topic cards will be generated here -->
        </div>
      </div>
      
      <!-- Recommendations Section -->
      <div class="section-card">
        <div class="section-title">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫—É—Ä—Å–∞–º</div>
        <div class="recommendations-subtitle">
          –ò–∑—É—á–∏—Ç–µ —ç—Ç–∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∑–Ω–∞–Ω–∏–π –ø–æ —Ç–µ–º–∞–º,<br>–∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏—è.
        </div>
        
        <div id="recommendationsList">
          <!-- Recommendations will be generated here -->
        </div>
      </div>
      
      <!-- Footer -->
      <div class="pdf-footer">
        –î–æ–∫—É–º–µ–Ω—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω: <span id="dateTime"></span>
      </div>
    </div>
  </div>

  <script>
    // Sample data
    const testData = {
      testName: '–¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏',
      passed: false,
      percent: 75,
      attempts: 2,
      totalQuestions: 4,
      correctAnswers: 3,
      totalCorrect: 3,
      points: 3,
      topics: [
        {
          name: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤',
          passed: false,
          correct: 4,
          total: 10,
          percent: 100,
          points: '0.0/4.0',
          feedback: '–í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã. –í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã.'
        },
        {
          name: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤',
          passed: true,
          correct: 4,
          total: 10,
          percent: 100,
          points: '0.0/4.0',
          feedback: '–í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã. –í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã.'
        },
        {
          name: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤',
          passed: false,
          correct: 4,
          total: 10,
          percent: 100,
          points: '0.0/4.0',
          feedback: '–í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã. –í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã.'
        },
        {
          name: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤',
          passed: true,
          correct: 4,
          total: 10,
          percent: 100,
          points: '0.0/4.0',
          feedback: '–í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã. –í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã.'
        },
        {
          name: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤',
          passed: false,
          correct: 4,
          total: 10,
          percent: 100,
          points: '0.0/4.0',
          feedback: '–í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã. –í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã.'
        },
        {
          name: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤',
          passed: true,
          correct: 4,
          total: 10,
          percent: 100,
          points: '0.0/4.0',
          feedback: '–í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã. –í–æ—Ç —Ç—É—Ç –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –¥–ª—è —Ç–µ–º—ã.'
        }
      ],
      recommendations: [
        { topic: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤', course: '–¢—É—Ç –∫—É—Ä—Å' },
        { topic: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤', course: '–¢—É—Ç –∫—É—Ä—Å' },
        { topic: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤', course: '–¢—É—Ç –∫—É—Ä—Å' },
        { topic: '–í—Å–µ –≤–∏–¥—ã –≤–æ–ø—Ä–æ—Å–æ–≤', course: '–¢—É—Ç –∫—É—Ä—Å' }
      ]
    };

    // Background configs - logo-light.png –¥–ª—è –≤—Å–µ—Ö —Ç—ë–º–Ω—ã—Ö –ø–æ–¥–ª–æ–∂–µ–∫
    const backgrounds = {
      1: { bg: 'pdf-bg-1.png', logo: 'logo-light.png' },
      2: { bg: 'pdf-bg-2.png', logo: 'logo-light.png' },
      3: { bg: 'pdf-bg-3.png', logo: 'logo-light.png' }
    };

    let currentBg = 1;

    function changeBg() {
      const select = document.getElementById('bgSelect');
      const value = select.value;
      
      if (value === 'random') {
        currentBg = Math.floor(Math.random() * 3) + 1;
      } else {
        currentBg = parseInt(value);
      }
      
      const config = backgrounds[currentBg];
      document.getElementById('pdfBg').src = config.bg;
      document.getElementById('pdfLogo').src = config.logo;
    }

    function toggleStatus() {
      testData.passed = !testData.passed;
      renderPage();
    }

    function renderPage() {
      const mainTitle = document.getElementById('mainTitle');
      const statusBadge = document.getElementById('statusBadge');
      const scoreCircle = document.getElementById('scoreCircle');
      
      if (testData.passed) {
        mainTitle.textContent = '–¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω';
        mainTitle.className = 'main-title passed';
        statusBadge.textContent = '–ø—Ä–æ–π–¥–µ–Ω';
        statusBadge.className = 'status-badge passed';
        scoreCircle.style.setProperty('--progress-color', '#22c55e');
      } else {
        mainTitle.textContent = '–¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω';
        mainTitle.className = 'main-title failed';
        statusBadge.textContent = '–Ω–µ –ø—Ä–æ–π–¥–µ–Ω';
        statusBadge.className = 'status-badge failed';
        scoreCircle.style.setProperty('--progress-color', '#ef4444');
      }
      
      // Update values
      document.getElementById('attemptsCount').textContent = testData.attempts;
      document.getElementById('testName').textContent = testData.testName;
      document.getElementById('totalQuestions').textContent = testData.totalQuestions;
      document.getElementById('correctAnswers').textContent = testData.totalCorrect + '/' + testData.totalQuestions;
      document.getElementById('totalPoints').textContent = testData.points;
      document.getElementById('scoreValue').textContent = testData.percent + '%';
      scoreCircle.style.setProperty('--percent', testData.percent);
      
      // Render topics
      const topicsGrid = document.getElementById('topicsGrid');
      topicsGrid.innerHTML = testData.topics.map(topic => `
        <div class="topic-card ${topic.passed ? 'passed' : 'failed'}">
          <div class="topic-header">
            <div class="topic-name">${topic.name}</div>
            <div class="topic-status ${topic.passed ? 'passed' : 'failed'}">
              ${topic.passed ? '–ü—Ä–æ–π–¥–µ–Ω' : '–ù–µ –ø—Ä–æ–π–¥–µ–Ω'}
            </div>
          </div>
          <div class="topic-stats">
            <span>${topic.correct} –∏–∑ (${topic.percent}%)</span>
            <span>${topic.points}</span>
          </div>
          <div class="topic-progress">
            <div class="topic-progress-fill ${topic.passed ? 'passed' : 'failed'}" style="width: ${topic.percent}%"></div>
          </div>
          <div class="topic-feedback">${topic.feedback}</div>
        </div>
      `).join('');
      
      // Render recommendations
      const recommendationsList = document.getElementById('recommendationsList');
      recommendationsList.innerHTML = testData.recommendations.map(rec => `
        <div class="recommendation-row">
          <div class="recommendation-topic">${rec.topic}</div>
          <div class="recommendation-course">${rec.course}</div>
        </div>
      `).join('');
      
      // Update date
      document.getElementById('dateTime').textContent = new Date().toLocaleString('ru-RU');
    }

    async function generatePDF() {
      const element = document.getElementById('pdfPage');
      
      try {
        const canvas = await html2canvas(element, {
          scale: 2,
          useCORS: true,
          allowTaint: true,
          backgroundColor: null
        });
        
        const { jsPDF } = window.jspdf;
        
        const imgWidth = 210;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        
        const pdf = new jsPDF({
          orientation: 'portrait',
          unit: 'mm',
          format: [imgWidth, Math.max(imgHeight, 297)]
        });
        
        const imgData = canvas.toDataURL('image/png');
        pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
        pdf.save('–†–µ–∑—É–ª—å—Ç–∞—Ç—ã_—Ç–µ—Å—Ç–∞.pdf');
        
      } catch (error) {
        console.error('Error:', error);
        alert('–û—à–∏–±–∫–∞: ' + error.message);
      }
    }

    // Initialize
    window.onload = function() {
      changeBg();
      renderPage();
    };
  </script>
</body>
</html>